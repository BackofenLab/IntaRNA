
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/drawseq1 { % print sequence1
[ [0.7 -0.3 ]
  [0.7 0.7 len2 add]
] {
   gsave
    aload pop translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence1 exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawseq2 { % print sequence2
[ [-0.3 len2 sub -0.4 -90]
  [-0.3 len2 sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len2 1 sub {
     dup 0 moveto
     sequence2 exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len2 lineto % vertical
     stroke
  } for

  len log 0.9 sub cvi 10 exch exp  % grid spacing
  0 exch len2 {
     dup
     len2 exch sub 0 exch moveto
     len exch len2 exch sub lineto % horizontal
     stroke
  } for

  grestore
} bind def
